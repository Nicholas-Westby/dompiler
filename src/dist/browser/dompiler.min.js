class Dompiler{constructor(){this.nestedElements={},this.namedElements={},this.nestedCount=0}compile(e){let t=document.createRange().createContextualFragment(e.trim()),n=t.querySelectorAll("[dompiler-element]");return n.forEach(e=>{let t=e.getAttribute("dompiler-element");e.removeAttribute("dompiler-element"),this.namedElements[t]=e}),(n=t.querySelectorAll("[dompiler-list]")).forEach(e=>{let t=e.getAttribute("dompiler-list");e.removeAttribute("dompiler-list");let n=this.namedElements[t]||[];n.push(e),this.namedElements[t]=n}),(n=t.querySelectorAll("[dompiler-nested-element]")).forEach(e=>{let t=e.getAttribute("dompiler-nested-element"),n=this.nestedElements[t];e.parentNode.replaceChild(n,e)}),t}namedElement(e){return`dompiler-element="${e}"`}namedElementList(e){return`dompiler-list="${e}"`}each(e,t){let n=document.createDocumentFragment();return e.forEach((e,l)=>{let i=t(e,l),m=document.createRange().createContextualFragment(i);n.appendChild(m)}),this.asString(n)}asString(e){let t=document.createElement("div");return t.appendChild(e),t.innerHTML}nestElements(e){let t=this.nestedCount.toString(),n=document.createDocumentFragment();return this.nestedCount++,e.forEach(e=>{n.appendChild(e)}),this.nestedElements[t]=n,`<div dompiler-nested-element="${t}"></div>`}nestElement(e){return this.nestElements([e])}withBinding(){return{compile:this.compile.bind(this),namedElement:this.namedElement.bind(this),namedElementList:this.namedElementList.bind(this),each:this.each.bind(this),nestElements:this.nestElements.bind(this),nestElement:this.nestElement.bind(this),elements:this.namedElements}}}export default Dompiler;